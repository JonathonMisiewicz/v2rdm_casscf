#! cc-pvdz N2 (6,6) active space Test DQG

sys.path.insert(0, '../../..')
import v2rdm_casscf

molecule n2 {
0 1
n
n 1 r
}

set {
  basis cc-pvdz
  scf_type cd
  cholesky_tolerance 1e-12
  d_convergence      1e-10
  maxiter 500
  frozen_docc  [ 2, 0, 0, 0, 0, 2, 0, 0 ]
  frozen_uocc  [ 4, 1, 2, 2, 1, 4, 2, 2 ]
}
set v2rdm_casscf {
  positivity dqg
  r_convergence  1e-4
  e_convergence  1e-4
  maxiter 20000
}

activate(n2)

n2.r     = 0.5
refscf   = -103.04337420425341 # TEST
refv2rdm = -103.086367952045   # TEST

energy('v2rdm-casscf')

compare_values(refscf, get_variable("SCF TOTAL ENERGY"), 8, "SCF total energy") # TEST
compare_values(refv2rdm, get_variable("CURRENT ENERGY"), 4, "v2RDM-CASSCF total energy") # TEST

n2.r     = 1.1
refscf   = -108.95379624015733 # TEST
refv2rdm = -109.094829146441   # TEST

energy('v2rdm-casscf')

compare_values(refscf, get_variable("SCF TOTAL ENERGY"), 8, "SCF total energy") # TEST
compare_values(refv2rdm, get_variable("CURRENT ENERGY"), 4, "v2RDM-CASSCF total energy") # TEST
