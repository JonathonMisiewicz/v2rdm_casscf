    -----------------------------------------------------------------------
          Psi4: An Open-Source Ab Initio Electronic Structure Package
                              Psi4 (no tag) Driver

    J. M. Turney, A. C. Simmonett, R. M. Parrish, E. G. Hohenstein,
    F. A. Evangelista, J. T. Fermann, B. J. Mintz, L. A. Burns, J. J. Wilke,
    M. L. Abrams, N. J. Russ, M. L. Leininger, C. L. Janssen, E. T. Seidl,
    W. D. Allen, H. F. Schaefer, R. A. King, E. F. Valeev, C. D. Sherrill,
    and T. D. Crawford, WIREs Comput. Mol. Sci. 2, 556-565 (2012)
    (doi: 10.1002/wcms.93)

                         Additional Contributions by
    A. E. DePrince, M. Saitow, U. Bozkaya, A. Yu. Sokolov
    -----------------------------------------------------------------------


    Psi4 started on: Mon Mar  7 16:57:21 2016

    Process ID:   7612
    PSI4DATADIR: /home/jacob/softwares/valgrind/psi4public-master/build/share/psi
    Memory level set to 256.000 MB

  ==> Input File <==

--------------------------------------------------------------------------

# PYTHONPATH must include directory above plugin directory.
#     Define either externally or here, then import plugin.
sys.path.insert(0, '/home/jacob/v2rdm_casscf/')
import v2rdm_grad
memory 1000 mb
molecule mol {
0 1

#H	0.0000	0.0000	0.0000
#H 	0.0000 	0.0000 	0.7414
n
n 1 r

#symmetry c1
}

set {
  guess sad
  basis cc-pvdz
  scf_type df
  d_convergence 1e-8
  maxiter 500
  reference rhf
  restricted_docc  [ 2, 0, 0, 0, 0, 2, 0, 0 ]
  restricted_uocc  [ 4, 1, 2, 2, 1, 4, 2, 2 ]
  #frozen_docc  [  4 ]
  #frozen_uocc  [ 18 ]

}
mol.r =1.1
gradient('OMP2',dertype=1)
#gradient('scf',dertype=1)
anal_grad = psi4.wavefunction().gradient()

set v2rdm_grad{
  positivity dqg
  constrain_spin true
  constrain_d3   false
  spin_adapt_g2  false
  spin_adapt_q2  false
  r_convergence  1e-3
  e_convergence  1e-3
  cg_convergence 1e-6
  maxiter 100000
  DERTYPE FIRST
}

activate(mol)
#mol.r =1.1
energy('v2rdm_grad')
#energy('cas2rdm')
#for i in range (0,63):
#    r = 0.8 + i*0.1
#    mol.r = r
#    set guess sad
#    energy('cas2rdm')
#    set guess read
--------------------------------------------------------------------------
/home/jacob/v2rdm_casscf/v2rdm_grad/v2rdm_grad.so loaded.

  Memory set to 1000.000 MiB by Python script.
Setting geometry variable r to 1.100000
gradient() will perform analytic gradient computation.
  DFOCC does not make use of molecular symmetry, further calculations in C1 point group.

*** tstart() called on numerica
*** at Mon Mar  7 16:57:21 2016


         ---------------------------------------------------------
                                   SCF
            by Justin Turney, Rob Parrish, and Andy Simmonett
                              RHF Reference
                        1 Threads,   1000 MiB Core
         ---------------------------------------------------------

  ==> Geometry <==

    Molecular point group: c1
    Full point group: D_inf_h

    Geometry (in Angstrom), charge = 0, multiplicity = 1:

       Center              X                  Y                   Z       
    ------------   -----------------  -----------------  -----------------
           N          0.000000000000     0.000000000000    -0.550000000000
           N          0.000000000000     0.000000000000     0.550000000000

  Running in c1 symmetry.

  Rotational constants: A = ************  B =      1.98984  C =      1.98984 [cm^-1]
  Rotational constants: A = ************  B =  59653.84444  C =  59653.84444 [MHz]
  Nuclear repulsion =   23.572439291736362

  Charge       = 0
  Multiplicity = 1
  Electrons    = 14
  Nalpha       = 7
  Nbeta        = 7

  ==> Algorithm <==

  SCF Algorithm Type is DF.
  DIIS enabled.
  MOM disabled.
  Fractional occupation disabled.
  Guess Type is SAD.
  Energy threshold   = 1.00e-10
  Density threshold  = 1.00e-08
  Integral threshold = 0.00e+00

  ==> Primary Basis <==

  Basis Set: CC-PVDZ
    Number of shells: 12
    Number of basis function: 28
    Number of Cartesian functions: 30
    Spherical Harmonics?: true
    Max angular momentum: 2

  ==> Pre-Iterations <==

   -------------------------------------------------------
    Irrep   Nso     Nmo     Nalpha   Nbeta   Ndocc  Nsocc
   -------------------------------------------------------
     A         28      28       0       0       0       0
   -------------------------------------------------------
    Total      28      28       7       7       7       0
   -------------------------------------------------------

 OEINTS: Overlap, kinetic, potential, dipole, and quadrupole integrals
         stored in file 35.

  ==> Integral Setup <==

  ==> DFJK: Density-Fitted J/K Matrices <==

    J tasked:                  Yes
    K tasked:                  Yes
    wK tasked:                  No
    OpenMP threads:              1
    Integrals threads:           1
    Memory (MB):               715
    Algorithm:                Core
    Integral Cache:           SAVE
    Schwarz Cutoff:          1E-12
    Fitting Condition:       1E-12

   => Auxiliary Basis Set <=

  Basis Set: 
    Number of shells: 48
    Number of basis function: 140
    Number of Cartesian functions: 162
    Spherical Harmonics?: true
    Max angular momentum: 3

  Minimum eigenvalue in the overlap matrix is 6.1906036234E-03.
  Using Symmetric Orthogonalization.
  SCF Guess: Superposition of Atomic Densities via on-the-fly atomic UHF.

  ==> Iterations <==

                           Total Energy        Delta E     RMS |[F,P]|

   @DF-RHF iter   0:  -109.06081329010210   -1.09061e+02   8.29410e-02 
   @DF-RHF iter   1:  -108.94002454651606    1.20789e-01   5.86034e-03 
   @DF-RHF iter   2:  -108.95266920276781   -1.26447e-02   1.34878e-03 DIIS
   @DF-RHF iter   3:  -108.95343005253493   -7.60850e-04   3.27260e-04 DIIS
   @DF-RHF iter   4:  -108.95348811587660   -5.80633e-05   2.34706e-05 DIIS
   @DF-RHF iter   5:  -108.95348837232565   -2.56449e-07   3.09063e-06 DIIS
   @DF-RHF iter   6:  -108.95348837814315   -5.81750e-09   4.67172e-07 DIIS
   @DF-RHF iter   7:  -108.95348837830467   -1.61521e-10   4.31134e-08 DIIS
   @DF-RHF iter   8:  -108.95348837830575   -1.08002e-12   2.27947e-09 DIIS

  ==> Post-Iterations <==

    Orbital Energies (a.u.)
    -----------------------

    Doubly Occupied:                                                      

       1A    -15.687294     2A    -15.683937     3A     -1.469609  
       4A     -0.774890     5A     -0.626042     6A     -0.607131  
       7A     -0.607131  

    Virtual:                                                              

       8A      0.174361     9A      0.174361    10A      0.593802  
      11A      0.821219    12A      0.873141    13A      0.873141  
      14A      0.992144    15A      1.050649    16A      1.050649  
      17A      1.140869    18A      1.640793    19A      1.759650  
      20A      1.759650    21A      1.880643    22A      1.880643  
      23A      2.297692    24A      2.297692    25A      2.872203  
      26A      2.994434    27A      2.994434    28A      3.278797  

    Final Occupation by Irrep:
              A 
    DOCC [     7 ]

  Energy converged.

  @DF-RHF Final Energy:  -108.95348837830575

   => Energetics <=

    Nuclear Repulsion Energy =             23.5724392917363623
    One-Electron Energy =                -194.1397892176543394
    Two-Electron Energy =                  61.6138615476121458
    DFT Exchange-Correlation Energy =       0.0000000000000000
    Empirical Dispersion Energy =           0.0000000000000000
    PCM Polarization Energy =               0.0000000000000000
    EFP Energy =                            0.0000000000000000
    Total Energy =                       -108.9534883783058206

    Alert: EFP and PCM quantities not currently incorporated into SCF psivars.

Properties will be evaluated at   0.000000,   0.000000,   0.000000 Bohr
  ==> Properties <==


Properties computed using the SCF density matrix

  Nuclear Dipole Moment: (a.u.)
     X:     0.0000      Y:     0.0000      Z:     0.0000

  Electronic Dipole Moment: (a.u.)
     X:    -0.0000      Y:     0.0000      Z:    -0.0000

  Dipole Moment: (a.u.)
     X:    -0.0000      Y:     0.0000      Z:    -0.0000     Total:     0.0000

  Dipole Moment: (Debye)
     X:    -0.0000      Y:     0.0000      Z:    -0.0000     Total:     0.0000


  Saving occupied orbitals to File 180.

*** tstop() called on numerica at Mon Mar  7 16:57:22 2016
Module time:
	user time   =       0.67 seconds =       0.01 minutes
	system time =       0.00 seconds =       0.00 minutes
	total time  =          1 seconds =       0.02 minutes
Total time:
	user time   =       0.67 seconds =       0.01 minutes
	system time =       0.00 seconds =       0.00 minutes
	total time  =          1 seconds =       0.02 minutes

*** tstart() called on numerica
*** at Mon Mar  7 16:57:22 2016



  Options:
  ----------------------------------------------------------------------------
  ACTIVE                      => [  ]             
  BENCH                       => 0                
  CC_DIIS_MAX_VECS            => 6                
  CC_DIIS_MIN_VECS            => 2                
  CC_LAMBDA                   => FALSE            
  CC_MAXITER                  => 50               
  CC_TYPE                     => CONVENTIONAL     
  CEPA_OS_SCALE               => 1.27             
  CEPA_SOS_SCALE              => 1.3              
  CEPA_SS_SCALE               => 1.13             
  CEPA_TYPE                   => CEPA(0)          
  CHOLESKY_TOLERANCE          => 0.0001           
  COMPUT_S2                   => FALSE            
  CUBEPROP_BASIS_FUNCTIONS    => [  ]             
  CUBEPROP_FILEPATH           => .                
  CUBEPROP_ORBITALS           => [  ]             
  CUBEPROP_TASKS              => [  ]             
  CUBIC_BASIS_TOLERANCE       => 1e-12            
  CUBIC_BLOCK_MAX_POINTS      => 1000             
  CUBIC_GRID_OVERAGE          => [  ]             
  CUBIC_GRID_SPACING          => [  ]             
  CUTOFF                      => 8                
  DEBUG                       => 0                
  DERTYPE                     => FIRST           !
  DF_BASIS_CC                 => (empty)          
  DIE_IF_NOT_CONVERGED        => TRUE             
  DKH_ORDER                   => 2                
  DOCC                        => [  ]             
  DO_DIIS                     => TRUE             
  DO_LEVEL_SHIFT              => TRUE             
  DO_SCS                      => FALSE            
  DO_SOS                      => FALSE            
  E3_SCALE                    => 0.25             
  EKT_IP                      => FALSE            
  EXTERNAL_POTENTIAL_SYMMETRY => FALSE            
  E_CONVERGENCE               => 1e-08           !
  FREEZE_CORE                 => FALSE            
  FROZEN_DOCC                 => [  ]             
  FROZEN_UOCC                 => [  ]             
  HESS_TYPE                   => HF               
  INTEGRAL_CUTOFF             => 9                
  INTEGRAL_PACKAGE            => ERD              
  LEVEL_SHIFT                 => 0.02             
  LINEQ_SOLVER                => CDGESV           
  LITERAL_CFOUR               => (empty)          
  MAT_NUM_COLUMN_PRINT        => 5                
  MAX_MOGRAD_CONVERGENCE      => 0.001            
  MOLDEN_WRITE                => FALSE            
  MO_DIIS_NUM_VECS            => 6                
  MO_MAXITER                  => 50               
  MO_STEP_MAX                 => 0.5              
  MP2_AMP_TYPE                => DIRECT           
  MP2_OS_SCALE                => 1.2              
  MP2_SOS_SCALE               => 1.3              
  MP2_SOS_SCALE2              => 1.2              
  MP2_SS_SCALE                => 0.333333         
  NAT_ORBS                    => FALSE            
  NUM_FROZEN_DOCC             => 0                
  NUM_FROZEN_UOCC             => 0                
  OCC_ORBS_PRINT              => FALSE            
  OEPROP                      => FALSE            
  OO_SCALE                    => 0.01             
  OPT_METHOD                  => QNR              
  ORB_OPT                     => TRUE             
  ORB_RESP_SOLVER             => PCG              
  ORTH_TYPE                   => MGS              
  PCG_BETA_TYPE               => FLETCHER_REEVES  
  PCG_CONVERGENCE             => 1e-06            
  PCG_MAXITER                 => 50               
  PCM                         => FALSE            
  PCM_SCF_TYPE                => TOTAL            
  PRINT                       => 1                
  PROPERTIES                  => [  ]             
  PROPERTIES_ORIGIN           => [  ]             
  PUREAM                      => TRUE             
  QCHF                        => FALSE            
  RAS1                        => [  ]             
  RAS2                        => [  ]             
  RAS3                        => [  ]             
  RAS4                        => [  ]             
  READ_SCF_3INDEX             => TRUE             
  REGULARIZATION              => FALSE            
  REG_PARAM                   => 0.4              
  RELATIVISTIC                => NO               
  REL_BASIS                   => (empty)          
  RESTRICTED_DOCC             => [ 2, 0, 0, 0, 0, 2, 0, 0 ] !
  RESTRICTED_UOCC             => [ 4, 1, 2, 2, 1, 4, 2, 2 ] !
  RMS_MOGRAD_CONVERGENCE      => 1e-06            
  R_CONVERGENCE               => 1e-05            
  SCS_TYPE                    => SCS              
  SOCC                        => [  ]             
  SOS_TYPE                    => SOS              
  UNITS                       => ANGSTROMS        
  WABEF_TYPE                  => AUTO             
  WFN                         => SCF              
  WFN_TYPE                    => DF-OMP2          
  WRITER_FILE_LABEL           => (empty)          


 ============================================================================== 
 ============================================================================== 
 ============================================================================== 

                      DF-OMP2 (DF-OO-MP2)   
              Program Written by Ugur Bozkaya
              Latest Revision August 5, 2015

 ============================================================================== 
 ============================================================================== 
 ============================================================================== 

	RMS orbital gradient is changed to :     2.51e-06
	MAX orbital gradient is changed to :     1.05e-04
	MO spaces... 

	 FC   OCC   VIR   FV 
	----------------------
	  0    7    21    0
	Reading DF integrals from disk ...
	Number of basis functions in the DF-HF basis: 140
	Number of basis functions in the DF-CC basis: 112

	Available memory                      :    953.67 MB 
	Minimum required memory for amplitudes:      0.49 MB 
	Memory requirement for B-HF (Q|mu nu) :      0.84 MB 
	Memory requirement for B-HF (Q|ab)    :      0.47 MB 
	Memory requirement for DF-HF int trans:      1.94 MB 
	Memory requirement for B-CC (Q|mu nu) :      0.67 MB 
	Memory requirement for B-CC (Q|ab)    :      0.38 MB 
	Memory requirement for DF-CC int trans:      1.55 MB 

	Computing DF-MP2 energy using SCF MOs (Canonical DF-MP2)... 
	======================================================================= 
	Nuclear Repulsion Energy (a.u.)    :    23.57243929173636
	DF-HF Energy (a.u.)                :  -108.95348837830575
	REF Energy (a.u.)                  :  -108.95348837830575
	DF-MP2 Correlation Energy (a.u.)   :    -0.27851711980524
	DF-MP2 Total Energy (a.u.)         :  -109.23200549811099
	======================================================================= 

	Number of independent-pairs: 147

 ============================================================================== 
 ================ Performing DF-OMP2 iterations... ============================ 
 ============================================================================== 
	            Minimizing DF-MP2-L Functional 
	            ------------------------------ 
 Iter       E_total           DE           RMS MO Grad      MAX MO Grad      RMS T2    
 ----    ---------------    ----------     -----------      -----------     ---------- 
   1     -109.2248579694     -3.80e-03       2.24e-03         2.00e-02        4.70e-04 
   2     -109.2256570162     -7.99e-04       6.00e-04         4.23e-03        1.89e-04 
   3     -109.2256906146     -3.36e-05       1.11e-04         9.00e-04        7.16e-05 
   4     -109.2256390301      5.16e-05       3.39e-05         2.03e-04        2.24e-05 
   5     -109.2256312935      7.74e-06       9.90e-06         5.22e-05        3.45e-06 
   6     -109.2256287677      2.53e-06       1.45e-06         8.85e-06        7.26e-07 

 ============================================================================== 
 ======================== DF-OMP2 ITERATIONS ARE CONVERGED ==================== 
 ============================================================================== 

	Orbitals are optimized now.
	Transforming MOs to the semicanonical basis... 
	Switching to the standard DF-MP2 computation... 

	Computing MP2 energy using optimized MOs... 
	======================================================================= 
	Nuclear Repulsion Energy (a.u.)    :    23.57243929173636
	DF-HF Energy (a.u.)                :  -108.95348837830575
	REF Energy (a.u.)                  :  -108.94982032087550
	DF-MP2 Correlation Energy (a.u.)   :    -0.26238340983373
	DF-MP2 Total Energy (a.u.)         :  -109.21587178813948
	======================================================================= 

	======================================================================= 
	================ DF-OMP2 FINAL RESULTS ================================ 
	======================================================================= 
	Nuclear Repulsion Energy (a.u.)    :    23.57243929173636
	DF-HF Energy (a.u.)                :  -108.95348837830575
	REF Energy (a.u.)                  :  -108.94982032087550
	DF-OMP2 Correlation Energy (a.u.)  :    -0.26238340983373
	Edfomp2 - Eref (a.u.)              :    -0.26605146726398
	DF-OMP2 Total Energy (a.u.)        :  -109.21587178813948
	======================================================================= 


 ============================================================================== 
 ============================================================================== 
 ============================================================================== 

                         DFGRAD   
            A General Analytic Gradients Code   
               for Density-Fitted Methods       
                   by Ugur Bozkaya
              Latest Revision May 11, 2015

 ============================================================================== 
 ============================================================================== 
 ============================================================================== 

	Analytic gradients computation is starting...
	Forming Gamma^tilde...
	Backtransforming OPDM, TPDM, and GFM to the AO basis...
	Computing analytic gradients...

  -Nuclear Gradient:
     Atom            X                  Y                   Z
    ------   -----------------  -----------------  -----------------
       1        0.000000000000     0.000000000000    11.339997840053
       2        0.000000000000     0.000000000000   -11.339997840053


  -Kinetic Gradient:
     Atom            X                  Y                   Z
    ------   -----------------  -----------------  -----------------
       1        0.000159228076     0.002990355389     2.224309878004
       2       -0.000159228076    -0.002990355389    -2.224309878004


  -Potential Gradient:
     Atom            X                  Y                   Z
    ------   -----------------  -----------------  -----------------
       1       -0.000511030832    -0.039346822651   -30.079605776528
       2        0.000511030832     0.039346822651    30.079605776528


  -Overlap Gradient:
     Atom            X                  Y                   Z
    ------   -----------------  -----------------  -----------------
       1       -0.007480092867     0.004484449865     0.888549020650
       2        0.007480092867    -0.004484449865    -0.888549020650

	ref_grad is starting... 

  -Metric:RefSep Gradient:
     Atom            X                  Y                   Z
    ------   -----------------  -----------------  -----------------
       1        0.000288545893    -0.000312624831    -8.207496755615
       2       -0.000288545893     0.000312624831     8.207496755615


  -3-Index:RefSep Gradient:
     Atom            X                  Y                   Z
    ------   -----------------  -----------------  -----------------
       1       -0.000041155593     0.032702556998    23.763973373061
       2        0.000041155593    -0.032702556998   -23.763973373061

	ref_grad is done. 
RMS ID: %12.5 

  -One-Electron Gradient:
     Atom            X                  Y                   Z
    ------   -----------------  -----------------  -----------------
       1       -0.000351802755    -0.036356467262   -27.855295898524
       2        0.000351802755     0.036356467262    27.855295898524


  -Two-Electron Gradient:
     Atom            X                  Y                   Z
    ------   -----------------  -----------------  -----------------
       1        0.000247390301     0.032389932167    15.556476617446
       2       -0.000247390301    -0.032389932167   -15.556476617446


  -Total Gradient:
     Atom            X                  Y                   Z
    ------   -----------------  -----------------  -----------------
       1       -0.007584505322     0.000517914770    -0.070272420375
       2        0.007584505322    -0.000517914770     0.070272420375


*** tstop() called on numerica at Mon Mar  7 16:57:23 2016
Module time:
	user time   =       1.01 seconds =       0.02 minutes
	system time =       0.05 seconds =       0.00 minutes
	total time  =          1 seconds =       0.02 minutes
Total time:
	user time   =       1.68 seconds =       0.03 minutes
	system time =       0.05 seconds =       0.00 minutes
	total time  =          2 seconds =       0.03 minutes
CURRENT ENERGY: -109.2158717881

*** tstart() called on numerica
*** at Mon Mar  7 16:57:23 2016


         ---------------------------------------------------------
                                   SCF
            by Justin Turney, Rob Parrish, and Andy Simmonett
                              RHF Reference
                        1 Threads,   1000 MiB Core
         ---------------------------------------------------------

  ==> Geometry <==

    Molecular point group: d2h
    Full point group: D_inf_h

    Geometry (in Angstrom), charge = 0, multiplicity = 1:

       Center              X                  Y                   Z       
    ------------   -----------------  -----------------  -----------------
           N          0.000000000000     0.000000000000    -0.550000000000
           N          0.000000000000     0.000000000000     0.550000000000

  Running in d2h symmetry.

  Rotational constants: A = ************  B =      1.98984  C =      1.98984 [cm^-1]
  Rotational constants: A = ************  B =  59653.84444  C =  59653.84444 [MHz]
  Nuclear repulsion =   23.572439291736362

  Charge       = 0
  Multiplicity = 1
  Electrons    = 14
  Nalpha       = 7
  Nbeta        = 7

  ==> Algorithm <==

  SCF Algorithm Type is DF.
  DIIS enabled.
  MOM disabled.
  Fractional occupation disabled.
  Guess Type is SAD.
  Energy threshold   = 1.00e-08
  Density threshold  = 1.00e-08
  Integral threshold = 0.00e+00

  ==> Primary Basis <==

  Basis Set: CC-PVDZ
    Number of shells: 12
    Number of basis function: 28
    Number of Cartesian functions: 30
    Spherical Harmonics?: true
    Max angular momentum: 2

  ==> Pre-Iterations <==

   -------------------------------------------------------
    Irrep   Nso     Nmo     Nalpha   Nbeta   Ndocc  Nsocc
   -------------------------------------------------------
     Ag         7       7       0       0       0       0
     B1g        1       1       0       0       0       0
     B2g        3       3       0       0       0       0
     B3g        3       3       0       0       0       0
     Au         1       1       0       0       0       0
     B1u        7       7       0       0       0       0
     B2u        3       3       0       0       0       0
     B3u        3       3       0       0       0       0
   -------------------------------------------------------
    Total      28      28       7       7       7       0
   -------------------------------------------------------

 OEINTS: Overlap, kinetic, potential, dipole, and quadrupole integrals
         stored in file 35.

  ==> Integral Setup <==

  ==> DFJK: Density-Fitted J/K Matrices <==

    J tasked:                  Yes
    K tasked:                  Yes
    wK tasked:                  No
    OpenMP threads:              1
    Integrals threads:           1
    Memory (MB):               715
    Algorithm:                Core
    Integral Cache:           SAVE
    Schwarz Cutoff:          1E-12
    Fitting Condition:       1E-12

   => Auxiliary Basis Set <=

  Basis Set: 
    Number of shells: 48
    Number of basis function: 140
    Number of Cartesian functions: 162
    Spherical Harmonics?: true
    Max angular momentum: 3

  Minimum eigenvalue in the overlap matrix is 6.1906036234E-03.
  Using Symmetric Orthogonalization.
  SCF Guess: Superposition of Atomic Densities via on-the-fly atomic UHF.

  ==> Iterations <==

                           Total Energy        Delta E     RMS |[F,P]|

   @DF-RHF iter   0:  -109.06081329010208   -1.09061e+02   1.99140e-01 
   @DF-RHF iter   1:  -108.94002454651603    1.20789e-01   1.40706e-02 
   @DF-RHF iter   2:  -108.95266920276741   -1.26447e-02   3.23839e-03 DIIS
   @DF-RHF iter   3:  -108.95343005253473   -7.60850e-04   7.85746e-04 DIIS
   @DF-RHF iter   4:  -108.95348811587651   -5.80633e-05   5.63523e-05 DIIS
   @DF-RHF iter   5:  -108.95348837232565   -2.56449e-07   7.42055e-06 DIIS
   @DF-RHF iter   6:  -108.95348837814312   -5.81747e-09   1.12167e-06 DIIS
   @DF-RHF iter   7:  -108.95348837830458   -1.61464e-10   1.03515e-07 DIIS
   @DF-RHF iter   8:  -108.95348837830566   -1.08002e-12   5.47296e-09 DIIS

  ==> Post-Iterations <==

    Orbital Energies (a.u.)
    -----------------------

    Doubly Occupied:                                                      

       1Ag   -15.687294     1B1u  -15.683937     2Ag    -1.469609  
       2B1u   -0.774890     3Ag    -0.626042     1B2u   -0.607131  
       1B3u   -0.607131  

    Virtual:                                                              

       1B3g    0.174361     1B2g    0.174361     3B1u    0.593802  
       4Ag     0.821219     2B3u    0.873141     2B2u    0.873141  
       5Ag     0.992144     2B2g    1.050649     2B3g    1.050649  
       4B1u    1.140869     5B1u    1.640793     6Ag     1.759650  
       1B1g    1.759650     3B3u    1.880643     3B2u    1.880643  
       6B1u    2.297692     1Au     2.297692     7Ag     2.872203  
       3B2g    2.994434     3B3g    2.994434     7B1u    3.278797  

    Final Occupation by Irrep:
             Ag   B1g   B2g   B3g    Au   B1u   B2u   B3u 
    DOCC [     3,    0,    0,    0,    0,    2,    1,    1 ]

  Energy converged.

  @DF-RHF Final Energy:  -108.95348837830566

   => Energetics <=

    Nuclear Repulsion Energy =             23.5724392917363623
    One-Electron Energy =                -194.1397892176539415
    Two-Electron Energy =                  61.6138615476119540
    DFT Exchange-Correlation Energy =       0.0000000000000000
    Empirical Dispersion Energy =           0.0000000000000000
    PCM Polarization Energy =               0.0000000000000000
    EFP Energy =                            0.0000000000000000
    Total Energy =                       -108.9534883783056216

    Alert: EFP and PCM quantities not currently incorporated into SCF psivars.

Properties will be evaluated at   0.000000,   0.000000,   0.000000 Bohr
  ==> Properties <==


Properties computed using the SCF density matrix

  Nuclear Dipole Moment: (a.u.)
     X:     0.0000      Y:     0.0000      Z:     0.0000

  Electronic Dipole Moment: (a.u.)
     X:     0.0000      Y:     0.0000      Z:     0.0000

  Dipole Moment: (a.u.)
     X:     0.0000      Y:     0.0000      Z:     0.0000     Total:     0.0000

  Dipole Moment: (Debye)
     X:     0.0000      Y:     0.0000      Z:     0.0000     Total:     0.0000


  Saving occupied orbitals to File 180.

*** tstop() called on numerica at Mon Mar  7 16:57:23 2016
Module time:
	user time   =       0.72 seconds =       0.01 minutes
	system time =       0.00 seconds =       0.00 minutes
	total time  =          0 seconds =       0.00 minutes
Total time:
	user time   =       2.42 seconds =       0.04 minutes
	system time =       0.05 seconds =       0.00 minutes
	total time  =          2 seconds =       0.03 minutes
Reading options from the V2RDM_GRAD block
Calling plugin v2rdm_grad.so.

*** tstart() called on numerica
*** at Mon Mar  7 16:57:23 2016



        *******************************************************
        *                                                     *
        *    v-2RDM                                           *
        *                                                     *
        *    Ground-state variational 2-RDM optimization      *
        *    using a boundary-point semidefinite solver       *
        *                                                     *
        *    Eugene DePrince                                  *
        *                                                     *
        *******************************************************

  ==> Convergence parameters <==

        r_convergence:                      1.000e-03
        e_convergence:                      1.000e-03
        cg_convergence:                     1.000e-06
        maxiter:                               100000
        cg_maxiter:                             10000

  ==> Active space details <==

        Number of frozen core orbitals:             0
        Number of restricted occupied orbitals:     4
        Number of active occupied orbitals:         3
        Number of active virtual orbitals:          3
        Number of restricted virtual orbitals:     18
        Number of frozen virtual orbitals:          0

        Irrep:             Ag, B1g, B2g, B3g,  Au, B1u, B2u, B3u 
 
        frozen_docc     [   0,   0,   0,   0,   0,   0,   0,   0 ]
        restricted_docc [   2,   0,   0,   0,   0,   2,   0,   0 ]
        active          [   1,   0,   1,   1,   0,   1,   1,   1 ]
        restricted_uocc [   4,   1,   2,   2,   1,   4,   2,   2 ]
        frozen_uocc     [   0,   0,   0,   0,   0,   0,   0,   0 ]

  ==> Orbital optimization parameters <==

        1-step algorithm:                       1
        g_convergence:                  1.000e-04
        e_convergence:                  1.000e-08
        frequency:                            200
        active-active rotations:                0
        exact diagonal Hessian:                 0
        number of DIIS vectors:                 0
        print iteration info:                   0

  ==> Memory requirements <==

        D2:                          0.00 mb
        Q2:                          0.00 mb
        G2:                          0.01 mb

        Total number of variables:           1500
        Total number of constraints:         1516
        Total memory requirements:        0.53 mb

    ==> Transform three-electron integrals <==


        Time for integral transformation:     0.09 s


    reference energy:        -108.953488378306
    frozen core energy:      -121.129881001051
    initial 2-RDM energy:     -90.215619226924

      oiter iiter        E(p)        E(d)      E gap)      mu     eps(p)     eps(d)
     starting integral derivative 

         ------------------------------------------------------------
                                   v2RDM GRAD                          
         ------------------------------------------------------------

  ==> Geometry <==

    Molecular point group: d2h
    Full point group: D_inf_h

    Geometry (in Angstrom), charge = 0, multiplicity = 1:

       Center              X                  Y                   Z       
    ------------   -----------------  -----------------  -----------------
           N          0.000000000000     0.000000000000    -0.550000000000
           N          0.000000000000     0.000000000000     0.550000000000

  Nuclear repulsion =   23.572439291736362

  ==> Basis Set <==

  Basis Set: CC-PVDZ
    Number of shells: 12
    Number of basis function: 28
    Number of Cartesian functions: 30
    Spherical Harmonics?: true
    Max angular momentum: 2


  -Nuclear Gradient:
     Atom            X                  Y                   Z
    ------   -----------------  -----------------  -----------------
       1        0.000000000000     0.000000000000    11.339997840053
       2        0.000000000000     0.000000000000   -11.339997840053


  -Kinetic Gradient:
     Atom            X                  Y                   Z
    ------   -----------------  -----------------  -----------------
       1        0.000000000000     0.000000000000     2.349786607622
       2        0.000000000000     0.000000000000    -2.349786607622


  -Potential Gradient:
     Atom            X                  Y                   Z
    ------   -----------------  -----------------  -----------------
       1        0.000000000000     0.000000000000   -30.792202974038
       2        0.000000000000     0.000000000000    30.792202974038


  -Overlap Gradient:
     Atom            X                  Y                   Z
    ------   -----------------  -----------------  -----------------
       1        0.000000000000     0.000000000000     0.937053794175
       2        0.000000000000     0.000000000000    -0.937053794175

  ==> DFJKGrad: Density-Fitted SCF Gradients <==

    Gradient:                    1
    J tasked:                  Yes
    K tasked:                  Yes
    OpenMP threads:              1
    Integrals threads:           1
    Memory (MB):               715
    Schwarz Cutoff:          0E+00
    Fitting Condition:       1E-12

   => Auxiliary Basis Set <=

  Basis Set: 
    Number of shells: 48
    Number of basis function: 140
    Number of Cartesian functions: 162
    Spherical Harmonics?: true
    Max angular momentum: 3

Jmhalf norm      1.51270 	 begin Master loop  
rms GQpq      0.36404
rms GQmn      0.06282
rms GPQ      0.20867
MO rms GPQ      0.76588
AO rms GPQ      0.76588
rms GQmn      0.17729

  -Metric Gradient:
     Atom            X                  Y                   Z
    ------   -----------------  -----------------  -----------------
       1       -0.000000000036     0.000000000001   -10.143200483530
       2        0.000000000036    -0.000000000001    10.143200483530


  -3index Gradient:
     Atom            X                  Y                   Z
    ------   -----------------  -----------------  -----------------
       1        0.000000000036    -0.000000000001    22.324178520657
       2       -0.000000000036     0.000000000001   -22.324178520657


  -Total Gradient:
     Atom            X                  Y                   Z
    ------   -----------------  -----------------  -----------------
       1        0.000000000000     0.000000000000    -3.984386695061
       2       -0.000000000000    -0.000000000000     3.984386695061

     exiting integral derivative 
